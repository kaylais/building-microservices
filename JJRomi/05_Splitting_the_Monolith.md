# CHAPTER 5. Splitting the Monolith

## 접합부가 중요하다.
- 경계가 있는 콘텍스트는 훌륭한 접합부*** 를 만든다. 조직 내의 응집력이 있고 느슨히 결합된 경계를 잘 표현하기 때문이다. 

## 분해하기
- 리팩토링 후 시간이 지나면서 잘 어울려 남아있는 코드와 그렇지 못한 코드를 알아내기 시작한다. 대개 끝까지 생존한 코드가 우리가 간과했을지 모를 경계가 있는 콘텍스트로 인식할 수 있다.
- 서비스를 분리하기 전에 모든 코드를 도메인에 따라 나눠진 패키지들에 따라 정렬할 필요가 없다.
- 한번에 모든 것을 바꾸려는 빅뱅(big-bang)접근법을 취할 필요가 없고, 천천히 조금씩 진행되는 것으로 인식해야 한다.

## 모놀리스를 분리하는 이유
> 모놀리식*** 서비스 또는 애플리케이션을 더 작게 만들려는 결정은 좋은 출발점이다. 그러나 시스템을 조금씩 깎아내듯이 분리하기를 강력히 권고하고 싶다.
- 변경의 속도 : 접합부를 서비스로 분리한다면, 독립된 자율적 개체가 되어 더욱 신속하게 변경 가능하다.
- 팀 구조 : 팀이 주로 작업하는 코드를 분리해서 모든 소유권을 가질 수 있다면 좋을 것이다.
- 보안 : 서비스를 분리한다면 개별 서비스를 모니터링 할 수 있고 데이터의 전송과 저장에 있어 추가적인 보호를 할 수 있다.
- 기술 : 코드를 분리해서 독립된 서비스로 만들 수 있다면 그것을 테스트할 수 있는 다른 구현 방식을 쉽게 고려할 수 있다.

## 뒤엉킨 의존성
> 뒤엉킨 모든 의존성의 출처가 대개 데이터베이스라는 것을 알게 해준다.
- 가능한 한 종속성이 낮은 접합부를 추출하기 원한다. 다양한 접합부를 의존성 비순환 방향 그래프를 볼 수 있다면 엉켜져 풀기 어려울 것 같은 접합부를 찾는 데 도움이 된다.

## 데이터베이스
- 데이터 베이스에서 접합부를 찾아야 깔끔하게 분리할 수 있지만 데이터베이스는 길들이기 매우 어렵다.

## 문제에 대처하기
- 하이버네이트와 같은 프레임워크가 지원하는 저장소 계층을 두고, 객체 또는 데이터 구조를 데이터베이스와 매핑하기 쉽게 만들어 코드를 데이터베이스와 바인딩하는 것이다. 만약 이러한 추세를 따라왔다면 코드를 경계가 있는 콘텍스트를 대표하는 패키지로 그룹화했을 것이다.
- 경계가 있는 콘텍스트 단위의 매핑 파일과 같은 것을 사용한다면 하이버네이트에서는 매우 명확할 것이다.
- 데이터를 시각화하기 위한 도구를 사용하는 껏이 서비스 경계로 확장될 수 있는 테이블 간의 결합을 이해하도록 도와준다.

## 외부 키 관계 깨뜨리기
- 외부 키 관계는 결과적으로 얻어진 서비스가 관리해야 하는 제약 조건이다.

## 공유 정적 데이터 분리
- 테이블을 각 패키지에 복제한다. 장기적으로 보면 그 테이블은 각 서비스 내부에서도 복제될 수 있으며, 잠재적으로 일관성 문제를 초래한다.
- 공유 정적 데이터를 코드로 다룬다. 아마도 서비스 부분으로 배포되는 속성 파일에 저장도거나 열거형 개체가 될 수 있다. 
- 정적 데이터를 특정 독립적인 서비스 안에 삽입한다. 

---
```
***모놀리스 : 단일체라는 의미지만, 이 장에서는 모놀리식 시스템, 서비스 및 애플리케이션을 뜻한다.
***접합부 : 코드베이스의 나머지 부분에 영향을 주지 않는 격리된 코드 부분, 마이클 페더스의 ‘레거시 코드 활용 전략’ 중에서 
```

