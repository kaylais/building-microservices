## 4. 통합  
  
우리 문제 영역에서 *느슨한 결합*과 *높은 응집력*의 이중 혜택을 가져다주는 접합부를 어떻게 찾는지 배웠다.  
개발자에 의한 변경은 때로 서비스 소비자측의 변경까지 초래하는 결과를 가져올 수 있지만, 가능하면 이러한 변경을 일으키지 않는 기술을 선택하고 싶을 것이다.   
서비스 통합에 필요한 좋은 기술을 선택하는 데 도움이 되는 몇 가지 지침이 있다. 

> 고객 생성은 단순한 CRUD 명령의 집합으로 간주될 수 있다.  
> 하지만 대부분의 시스템에서 그렇게 단순한 작업은 아니다.  
> 새로운 고객이 등록되면 금융 결제 또는 환영 이메일과 같은 부가적인 프로세스를 시작해야 하고,  
> 고객 정보를 변경하거나 삭제할 때는 또 다른 비즈니스 프로세스가 작동할 수 있다.  

* DB : 사실상 공유된 매우 큰 API로서 상당히 깨지기 쉬워, 대개 대규모의 회귀 테스트가 필요  
  
시간이 지나도 서비스 내부 변경 방식에 관한 자율성을 서비스에 줄 수 있도록  
소비자에게 서비스의 세부 구현이 은폐되기를 진심으로 원한다.  
그렇지 않으면 느슨한 결합과는 영영 이별이다.  
  
**좋은 마이크로서비스의 핵심 원칙은 강한 응집력과 느슨한 결합**    
  
### 동기 통신  
원격 서버에 대한 호출이 완료될 때까지 연산 작업이 중단    
- 언제 작업이 성공적으로 완료되었는지 알 수 있어서 추론하기 용이  
- 요청/응답 스타일  

##### 요청/응답 스타일(request/response)  
동기 통신 방식과 명확히 일치하지만, 비동기 통신에서는 콜백을 활용하여 작동할 수 있음  

### 비동기 통신 
호출자는 작업이 완료되었다는 회신을 기다리지 않으며, 심지어는 작업의 완료 여부에 관심이 없을 때도 있음  
- 클라이언트와 서버 간에 오랫동안 접속을 유지하기 어려운 장기 작업에 유용  
- 결과를 기다리는 동안 중단된 호출이 성능 저하를 일으키는 곳에서 짧은 지연시간이 필요할 때 적합  
- 이벤트 기반 협업  

##### 이벤트 기반 협업  
- 클라이언트는 완료되어야 할 작업을 요청하는 대신 이벤트가 발생했음을 알리고 다른 당사자들이 무엇을 해야 할지 알기 기대함  
- 우리는 결코 다른 누구에게도 해야할 일을 말하지 않는 것  
- 결합도가 매우 낮은 방식  

### 오케스트레이션(orchestration) 방식   
오케스트라 지휘자처럼 프로세를 안내하고 구동하는 하나의 중앙 두뇌에 의존   
- 고객 서비스에 지나치게 많은 중앙 관리 권한이 부여되는 단점  
- 웹 중간에서 허브가 되어 로직이 살아나는 중심점이 될 수 있음  
- 이 방식은 빈약한 CRUD 기반의 서비스에 할 일을 지시하는 소수의 똑똑한 신과 같은 서비스를 낳음  

### 크레오그래피(choreography) 방식   
발레 무용수들이 자신의 역할을 주변의 다른 무용수에 반응하는 것처럼 시스템 각 부분에 작업 내용 내용을 알리고 세부 사항을 수행  
- 고객 서비스가 비동기 방식으로 고객이 생성되었다라는 이벤트를 발산할 뿐  
- 시스템에 암시적으로 반영되었다는 것  
- 모든 일이 제대로 수행되는지 모니터하고 추적하기 위한 추가 작업이 필요하다는 것을 의미  

> 분산 컴퓨팅에 대한 유명한 착오, 네트워크는 신뢰할 수 있다?!  
> -> 네트워크는 신뢰할 수 없다!  
클라이언트와 서버가 정상이라 하더라도 네트워크는 실패할 수 있고, 심지어 패킷을 변형할 수 있음을 명심  
   
--- 
  
## REST - REpresentational State Transfer   

웹에서 영감을 얻은 아키텍쳐 방식으로 resource의 개념 이 가장 중요  
자원이 외부에 보여지는 방식과 내부에 저장되는 방식은 완전히 분리<sup id="fnref1"><a href="#fn1">1</a></sup>   



--- 
* 콜백  
다른 코드의 인수로 넘겨주는 실행 가능한 코드  
콜백을 넘겨받는 코드는 이 콜백을 필요에 따라 즉시 실행할 수도 있고 나중에 실행할 수도 있음  

* 원격 프로시저 호출(remote procedure call/RPC)  
local call을 통해 원격 서비스를 실행하는 기술   

<ol>
  <li id="fn1">
    <p>다양한 REST 방식을 비교한 Richardson Maturity Model을 참고 <a href="#fnref1">↩</a></p>
  </li>
</ol>
