## 5. 모놀리스 분해하기  

> 모놀리스는 시간이 흐르면서 자라나고,  
> 빠른 속도로 새로운 기능과 코드 라인을 요구하며,  
> 머지않아 조직 내 사람들이 건드리거나 바꾸기를 두려워하는 거대하고 무서운 존재가 된다.  

### 좋은 접합부란?  
경계가 있는 콘텍스트(bounded context)  
조직 내의 응집력 있고, 느슨히 결합된 경계를 잘 표현  

### 리팩토링  
현대적 IDE에서 코드 이동은 리팩토링 기능을 통해 다른 작업 중에 자동적이고 점진적으로 이뤄질 수 있음  
하지만 코드 이동에 따른 오류를 잡아내기 위해 여전히 테스트가 필요  
시간이 지나면서 우리는 잘 어울려 남아 있는 코드와 그렇지 못한 코드를 알아가기 시작  
대게 끝까지 생존한 코드가 우리가 간과했을지 모를 경계가 있는 콘텍스트로 인식될 수 있음  
- 서비스를 분리하기 전에 모든 코드를 도메인에 따라 나눠진 패키지들에 따라 정렬할 필요는 없다  
- 한번에 모든 것을 바꾸려는 빅뱅(Big-bang) 접근법을 취할 필요는 없고, 이 과정을 천천히 조금씩 진행되는 것으로 인식  
- 뒤엉킨 모든 의존성의 출처가 대게 데이터베이스라는 것  

### 외부 키 관계 깨뜨리기  
특정 콘텍스트의 코드 내에 데이터베이스 맵핑 코드를 함께 배치하면 어떤 코드가 데이터베이스의 어느 부분을 사용하는지 이해할 수 있음  
예를 들어 경계가 잇는 콘텍스트 단위의 맵핑 파일과 같은 것을 사용한다면 하이버네이트에서는 매우 명확  
* 스키마스파이(SchemaSpy) : 테이블 관계를 그래픽으로 표현하는 도구  
이 모든 것은 궁극적으로 서비스 경계로 확장될 수 있는 테이블 간의 결합을 이해하도록 해줌  
- 보고서를 생성하기 위해 서로 다른 두 개의 데이터베이스에 호출해야 하는 것은 분명하며 옳은 것  

### 공유 데이터 분리  
- 각 패키지에 복제, 장기적으로 보면 그 테이블은 각 서비스 내부에서도 복제 될 수 있음  
- 공유 정적 데이터를 코드로 다루는 것  
  - 서비스의 부분으로 배포되는 속성 파일에 저장되거나,  
  - 열거형 개체(enumeration)가 될 수 있음  
  - 동작 중인 데이터베이스 테이블을 변경하는 것보다 설정 파일을 변경하는 것이 용이하나 데이터 일관성에 대한 문제는 여전히 존재  


---

**접합부**  
seam  

**structure101**  
애자일 아키텍처 개발 환경으로, 코드베이스의 구조화를 돕기 위해 다양한 IDE를 위한 플러그인을 제공  

**SKU(Stock Keeping Unit)**  
개별 상별 상품에 대해 재고 관리 목적으로 추적이 쉽도록 하기 위해 사용하는 식별 관리 코드  

